<div *ngIf="project">
  <div class="header">
    <div class="pointer back" routerLink="/">
      <i class="fa-solid fa-arrow-left fa-lg"></i>
      <span>Back</span>
    </div>
    <div class="name">
      <ng-container *ngIf="!editName; else editNameInput">
        <h2>{{ project.data.name }}</h2>
        <div class="pointer" (click)="editName = true">
          <i class="fa-solid fa-pen fa-lg"></i>
        </div>
      </ng-container>
      <ng-template #editNameInput>
        <input type="text"
               [(ngModel)]="project.data.name"
               [ngClass]="{ 'ng-invalid': project.data.name.length < 1 || project.data.name.length > 16 }"
               (change)="saveProjectName()">
        <div *ngIf="project.data.name.length > 0 && project.data.name.length <= 16" class="pointer" (click)="editName = false">
          <i class="fa-solid fa-xmark fa-lg"></i>
        </div>
      </ng-template>
    </div>
    <div class="options">
      <div class="pointer" (click)="archive()">
        <i class="fa-solid fa-box-archive fa-lg"></i>
      </div>
      <div class="pointer" (click)="delete()">
        <i class="fa-solid fa-trash fa-lg"></i>
      </div>
    </div>
  </div>

  <div>
    <div class="input">
      <label for="description">Description</label>
      <textarea
        id="description"
        type="text"
        [(ngModel)]="project.data.description"
        (ngModelChange)="projectService.saveProject(project)">
        </textarea>
    </div>

    <div class="categories">

    </div>

    <div class="balances">
      <form *ngIf="form" [formGroup]="form"
            (ngSubmit)="form.valid && createBalance()">
        <div class="balance-form">
          <div class="form-row">
            <div class="input">
              <label for="balance-label">Label</label>
              <input id="balance-label"
                     type="text"
                     formControlName="label"
                     autocomplete="off"
                     required>
              <app-errors [control]="label"></app-errors>
            </div>

            <div class="input">
              <label for="balance-amount">Amount</label>
              <input id="balance-amount"
                     type="number"
                     formControlName="amount"
                     required>
              <app-errors [control]="amount"></app-errors>
            </div>
          </div>

          <div>
            <button type="submit">Create balance</button>
          </div>
        </div>
      </form>
      <ng-container *ngIf="balanceService.balances">
        <div *ngFor="let balance of balanceService.balances" class="balance">
          <div class="label">
            <div class="pointer" (click)="balanceService.deleteBalance(balance)">
              <i class="fa-solid fa-trash"></i>
            </div>
            <div>{{ balance.data.label }}</div>
          </div>
          <div class="amount"
               [ngClass]="{ negative: (balance.data.amount ?? 0) < 0 }">{{ balance.data.amount }}</div>
        </div>
      </ng-container>
    </div>
  </div>
</div>
